<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!-- Apple Support -->
    <meta name="apple-mobile-web-app-title" content="FFBExecute">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width">

    <link rel="apple-touch-icon" sizes="180x180" href="/piper/resource/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/piper/resource/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/piper/resource/favicon-16x16.png">
    <link rel="manifest" href="/piper/resource/site.webmanifest">
    <link rel="mask-icon" href="/piper/resource/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/piper/resource/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="/piper/resource/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">

    <title>Phone Piper - Web Interface</title>

    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <script type="text/javascript" src="http://code.jquery.com/jquery-3.3.1.min.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

    <style type="text/css">
        .updatedValue {
            background-color:#f7b2b2;
        }


    </style>

    <script type="text/javascript">
        $(function(){

            var device1 = $('#device1');
            var view1 = $('#view1');
            var view2 = $('#view2');
            var script1 = $('#script1');
            var script2 = $('#script2');
            var script3 = $('#script3');
            var script4 = $('#script4');
            var statusName = $('#statusName');

            var logs = $('#logs');
            var states = $('#states');
            var components = $('#components');
            var editComponents = $('#edit-components');
            var editScreens = $('#edit-screens');

            var editForm = $('#edit-form');

            var playerLevel = $('#player-level');
            var deviceIp = $('#device-ip');
            var deviceAdb = $('#device-adb');
            var deviceWifi = $('#device-wifi');
            var deviceDirect = $('#device-direct');

            var playPauseButton = $('#controlPlayPause');
            var unloadButton = $('#controlUnload');
            var killButton = $('#controlKill');
            var unloadEdit = $('#unloadEdit');
            var loadButton = $('#controlLoad');
            var saveButton = $('#controlSave');
            var editViewButton = $('#controlEditView');

            var controlPlayerSave = $('#controlPlayerSave');
            var controlDeviceSave = $('#controlDeviceSave');
            var controlDeviceDirectSave = $('#controlDeviceDirectSave');
            var controlDeviceAdbSave = $('#controlDeviceAdbSave');
            var controlDeviceWifiSave = $('#controlDeviceWifiSave');

            var settingForm = $('#setting-form');
            var playerForm = $('#player-form');
            var variableForm = $('#variable-form');
            var variableContainer = $('#variable-container');
            var loadedForm = $('#loaded-form');

            var controlAdb = $('.controlAdb');
            var adbInfo = $('#adb-info');
            var linkedVariables = {};

            var notWhileRunning = $('.notWhileRunning');

            var logItems = [];

            var configList = $('#config-list');

            var configs = [];

            function populateSelect(select, items) {
                var i = 0;
                select.empty();
                for (i = 0; i < items.length; i++) {
                    select.append($('<option></option>').text(items[i]).attr('value', items[i]));
                }
            }

            view1.change(function(){
                view2.prop('disabled', !view1.val());
            });

            script1.change(function(){
                script2.prop('disabled', !script1.val());
            });

            script2.change(function(){
                script3.prop('disabled', !script2.val());
            });

            script3.change(function(){
                script4.prop('disabled', !script3.val());
            });

            function createGroup(name, field, button) {
                var grp = $('<div class="input-group mb-3"></div>').appendTo(variableContainer);
                $('<div class="input-group-prepend"></div>').append($('<span class="input-group-text" id=""></span>').text(name)).appendTo(grp);
                field.appendTo(grp);
                $('<div class="input-group-append"></div>').append(button).appendTo(grp);
                return grp;
            }

            $('#controlUpdatePreview').click(function(){
                $('#previewImage').attr('src', '/piper/screen?time=' + (new Date().getTime()));
            });

            function statusCheck(firstTime) {
                $.getJSON({
                    url: '/piper/status',
                    data: {},
                    success: function(data){

                        var i = 0, item, div;

                        configList.hide();

                        statusName.text(data.status);

                        switch(data.status) {
                            case 'EDIT_VIEW': {
                                editForm.show();
                                settingForm.hide();
                                if (firstTime) {
                                    $('[href="#edit"]').tab('show');
                                    loadEditViewInfo(true);
                                }
                            } break;
                            case 'INIT': {
                                editForm.hide();
                                playPauseButton.addClass('disabled');
                                unloadButton.addClass('disabled');
                                settingForm.show();
                                loadedForm.hide();
                                states.prop('disabled', true);
                                configList.show();
                            } break;
                            case 'READY': {
                                if (firstTime) {
                                    $('[href="#run"]').tab('show');
                                    loadProcessInfo(true);
                                } else {
                                    editForm.hide();
                                    playPauseButton.removeClass('disabled');
                                    unloadButton.removeClass('disabled');
                                    settingForm.hide();
                                    loadedForm.show();
                                    states.prop('disabled', false);
                                    notWhileRunning.prop('disabled', false);
                                }
                            } break;
                            case 'RUNNING':
                            case 'STOPPING':
                            case 'STOPPED': {
                                if (firstTime) {
                                    $('[href="#run"]').tab('show');
                                    loadProcessInfo(true);
                                } else {
                                    editForm.hide();
                                    playPauseButton.removeClass('disabled');
                                    unloadButton.removeClass('disabled');
                                    settingForm.hide();
                                    loadedForm.show();
                                    states.prop('disabled', true);
                                    notWhileRunning.prop('disabled', true);
                                    setTimeout(statusCheck, 3000);
                                }
                            } break;
                        }

                        if (data.state) {
                            states.val(data.state);
                        }

                        for (i = 0; i < data.logs.length; i++) {
                            item = data.logs[i];
                            div = $('<div class="row"></div>')
                            div.append($('<div class="col-sm-2 col-md-2 d-none d-sm-block"></div>').text(item.source));
                            div.append($('<div class="col-sm-4 col-md-2"></div>').text(item.timestamp));
                            div.append($('<div class="col-sm-2 col-md-2 d-none d-sm-block"></div>').text(item.level));
                            div.append($('<div class="col-sm-8 col-md-6"></div>').text(item.message));
                            logItems.push(div);
                            logs.prepend(div);
                        }

                        while (logItems.length > 50) {
                            logItems.splice(0,1)[0].detach();
                        }

                        if (data.variables.length > 0) {
                            for (i = 0; i < data.variables.length; i++) {
                                item = data.variables[i];
                                linkedVariables[item.name].val(formatVariable(item));
                            }
                        }

                    }
                });
            }

            $(".logging").change(function(){
                var ref = $(this), level = ref.val(), mode = ref.attr('mode');
                $.ajax({
                    type: "POST",
                    url: '/piper/process/level/' + mode + '/' + level,
                    success: function(result){

                    }
                });
            });

            playPauseButton.click(function(){
                if (!playPauseButton.hasClass('disabled')) {
                    $.ajax({
                      type: "POST",
                      url: '/piper/process/playPause/' + states.val(),
                      success: function(result){
                        statusCheck();
                      }
                    });
                }
            });

            unloadButton.click(function(){
                if (!unloadButton.hasClass('disabled')) {
                    $.ajax({
                      type: "POST",
                      url: '/piper/process/unload',
                      success: function(result){
                        statusCheck();
                        $('[href="#config"]').tab('show');
                      }
                    });
                }
            });

            saveButton.click(function(){
                if (!saveButton.hasClass('disabled')) {
                    saveConfig();
                }
            });

            killButton.click(function(){
                if (!unloadButton.hasClass('disabled')) {
                    $.ajax({
                        type: "POST",
                        url: '/piper/process/kill',
                        success: function(result){
                            statusCheck();
                            $('[href="#config"]').tab('show');
                        }
                    });
                }
            });

            unloadEdit.click(function(){
                if (!unloadEdit.hasClass('disabled')) {
                    $.ajax({
                      type: "POST",
                      url: '/piper/edit/unload',
                      success: function(result){
                        statusCheck();
                        $('[href="#config"]').tab('show');
                      }
                    });
                }
            });

            controlPlayerSave.click(function(){
                $.ajax({
                  type: "POST",
                  url: '/piper/player/level',
                  data: {value: playerLevel.val()}
                });
            });

            controlAdb.click(function(){
                adbInfo.val("Please Wait...");
                $.ajax({
                    type: "POST",
                    url: '/piper/adb/' + $(this).attr('adb'),
                    data: {},
                    success: function(result){
                        adbInfo.val(result.value || 'Done');
                    }
                });
            });

            controlDeviceSave.click(function(){
                $.ajax({
                  type: "POST",
                  url: '/piper/device/ip',
                  data: {value: deviceIp.val()}
                });
            });

            controlDeviceDirectSave.click(function(){
                $.ajax({
                  type: "POST",
                  url: '/piper/device/direct',
                  data: {value: deviceDirect.val()}
                });
            });

            controlDeviceAdbSave.click(function(){
                $.ajax({
                  type: "POST",
                  url: '/piper/device/adb',
                  data: {value: deviceAdb.val()}
                });
            });

            controlDeviceWifiSave.click(function(){
                $.ajax({
                  type: "POST",
                  url: '/piper/device/wifi',
                  data: {value: deviceWifi.val()}
                });
            });

            $('.controlButton').click(function(){
                var ref= $(this), button = ref.attr('controlButton'), componentId = $('#components').val();
                $.ajax({
                    type: "POST",
                    url: '/piper/button',
                    data: {buttonId: button, componentId: componentId}
                });
            });

            configList.on('click', 'button', function(){
                var ref = $(this), index = ref.attr('index') - 0;
                if (index >= 0 && index < configs.length) {
                    if (ref.hasClass('run-config')) {
                        applySelection(configs[index]);
                        loadButton.click();
                    } else if (ref.hasClass('delete-config')) {
                        configs.splice(index, 1);
                        localStorage.setItem("CONFIGS", JSON.stringify(configs));
                        buildConfigs();
                    }
                }
            });

            $('#new-config').click(function(){
                $('[href="#config"]').tab('show');
            });

            function doubleWide(numb) {
                if (numb < 10) {
                    return "0" + numb;
                }
                return numb;
            }

            function formatVariable(varDef) {
                switch(varDef.displayType) {
                    case 'STANDARD':
                        return varDef.value;
                    case 'TENTH': {
                        return ((varDef.value - 0) / 10.0).toFixed(1) + "%";
                    } break;
                    case 'BOOLEAN': {
                        return varDef.value - 0;
                    } break;
                    case 'SECONDS': {
                        var total = varDef.value - 0;
                        var hours = Math.floor(total / (3600));
                        total -= (hours * 3600);
                        var minutes = Math.floor(total / 60);
                        var seconds = total % 60;
                        return doubleWide(hours) + ":" + doubleWide(minutes) + ":" + doubleWide(seconds);
                    } break;
                }
            }

            function loadProcessInfo(firstTime) {
                $.ajax({
                  type: "GET",
                  url: '/piper/process/info',
                  success: function(result){
                    if (result.status == 'OK') {
                        states.empty();
                        components.empty();
                        var i, item, grp, label, input, button;
                        for (i = 0; i < result.states.length; i++) {
                        states.append($('<option></option>').attr('value', result.states[i].value).text(result.states[i].name).attr('description', result.states[i].description));
                        }
                        for (i = 0; i < result.components.length; i++) {
                        components.append($('<option></option>').attr('value', result.components[i].value).text(result.components[i].name));
                        }
                        $('#webLogging').val(result.webLevel);
                        $('#fileLogging').val(result.fileLevel);
                        variableContainer.empty();
                        linkedVariables = {};
                        if (result.variables.length > 0) {
                            variableForm.show();

                            var row;

                            for (i = 0; i < result.variables.length; i++) {
                                item = result.variables[i];

                                if (i == 0) {
                                    row = $('<div class="row"></div>').appendTo(variableContainer);
                                }

                                grp = $('<div class="input-group col-sm-12 col-md-6 col-lg-4" style="margin-bottom: 1em"></div>').appendTo(row);

                                $('<div class="input-group-prepend"></div>').append($('<span class="input-group-text" id=""></span>').text(item.display)).appendTo(grp);

                                if (item.displayType == 'BOOLEAN') {
                                    linkedVariables[item.name] = $('<select class="form-control notWhileRunning"><option value="0">False</option><option value="1">True</option></select>')
                                } else {
                                    linkedVariables[item.name] = $('<input type="text" class="form-control notWhileRunning"/>');
                                }

                                linkedVariables[item.name].data('key', item.name).val(formatVariable(item)).attr('id', 'var_' + item.name).appendTo(grp);
                                switch(item.modify) {
                                    case 'EDITABLE': {
                                        $('<div class="input-group-append"></div>').append($('<button class="btn btn-secondary updateVariable notWhileRunning" type="button">Update</button>').data('key', item.name).attr('for', 'var_' + item.name)).appendTo(grp);
                                    } break;
                                }
                            }
                        } else {
                            variableForm.hide();
                        }
                        statusCheck();
                    }
                  },
                  dataType: 'json'
                });
            }

            function loadEditViewInfo(firstTime) {
                $.ajax({
                  type: "GET",
                  url: '/piper/edit/view/info',
                  success: function(result){
                    if (result.status == 'OK') {
                        editScreens.empty();
                        editComponents.empty();
                        var i, item, grp, label, input, button;
                        for (i = 0; i < result.screens.length; i++) {
                            editScreens.append($('<option></option>').attr('value', result.screens[i].value).text(result.screens[i].name));
                        }
                        for (i = 0; i < result.components.length; i++) {
                            editComponents.append($('<option></option>').attr('value', result.components[i].value).text(result.components[i].name));
                        }
                        if (firstTime) {
                            statusCheck();
                        }
                    }
                  },
                  dataType: 'json'
                });
            }

            variableContainer.on('change', 'select, input', function(){
                var ref = $(this);
                ref.addClass('updatedValue');
            });

            variableContainer.on('click', 'button.updateVariable', function(){
                var ref = $(this), key = ref.data('key'), input = linkedVariables[key];
                input.removeClass('updatedValue');
                if (input.val()) {
                    $.ajax({
                      type: "POST",
                      url: '/piper/variable',
                      data: {key: key, value: input.val()}
                    });
                }
            });

            loadButton.click(function(){
                var blob = {
                    device: device1.val(),
                    view: view1.val(),
                    view2: view2.val(),
                    script: script1.val(),
                    script2: script2.val(),
                    script3: script3.val(),
                    script4: script4.val()
                };
                $.ajax({
                  type: "POST",
                  url: '/piper/process/prep',
                  data: JSON.stringify(blob),
                  headers: {
                        'Content-Type': 'application/json'
                    },
                  success: function(result){
                    if (result.status == 'OK') {
                        saveSelection();
                        loadProcessInfo(true);
                        $('[href="#run"]').tab('show');
                    }
                  },
                  dataType: 'json'
                });
            });

            editViewButton.click(function(){
                var blob = {
                    device: device1.val(),
                    view: view1.val(),
                    view2: view2.val(),
                    script: script1.val(),
                    script2: script2.val(),
                    script3: script3.val(),
                    script4: script4.val()
                };
                $.ajax({
                  type: "POST",
                  url: '/piper/edit/view',
                  data: JSON.stringify(blob),
                  headers: {
                        'Content-Type': 'application/json'
                    },
                  success: function(result){
                    if (result.status == 'OK') {
                        loadEditViewInfo(true);
                        $('[href="#edit"]').tab('show');
                    }
                  },
                  dataType: 'json'
                });

            });

            function firstTimeLoad() {

                $.getJSON({
                  url: '/piper/settings/list',
                  data: {},
                  success: function(data){
                    populateSelect(device1, data.devices || []);
                    populateSelect(view1, data.views || []);
                    populateSelect(view2, data.views || []);
                    populateSelect(script1, data.scripts || []);
                    populateSelect(script2, data.scripts || []);
                    populateSelect(script3, data.scripts || []);
                    populateSelect(script4, data.scripts || []);
                    loadSelection();

                    statusCheck(true);
                  }
                });

                $.getJSON({
                      url: '/piper/player/level',
                      data: {},
                      success: function(data){
                        playerLevel.val(data.value);
                        playerForm.show();
                      }
                  }
                );

                $.getJSON({
                      url: '/piper/device',
                      data: {},
                      success: function(data){
                        deviceIp.val(data.ip);
                        deviceAdb.val(data.adb);
                        deviceWifi.val(data.wifi);
                        deviceDirect.val(data.direct);
                      }
                  }
                );
            }

            function saveConfig() {

                var title = prompt("Configuration name?");

                if (!title) {
                    title = "Untitled " + (configs.length + 1);
                }

                var device1 = $('#device1').val();
                var view1 = $('#view1').val();
                var view2 = $('#view2').val();
                var script1 = $('#script1').val();
                var script2 = $('#script2').val();
                var script3 = $('#script3').val();
                var script4 = $('#script4').val();

                var data = {
                    device: device1 || '',
                    views: [],
                    scripts: []
                };
                if (view1) data.views.push(view1);
                if (view2) data.views.push(view2);
                if (script1) data.scripts.push(script1);
                if (script2) data.scripts.push(script2);
                if (script3) data.scripts.push(script3);
                if (script4) data.scripts.push(script4);
                data.title = title;

                configs.push(data);

                localStorage.setItem("CONFIGS", JSON.stringify(configs));

                buildConfigs();
            }

            function saveSelection() {

                var device1 = $('#device1').val();
                var view1 = $('#view1').val();
                var view2 = $('#view2').val();
                var script1 = $('#script1').val();
                var script2 = $('#script2').val();
                var script3 = $('#script3').val();
                var script4 = $('#script4').val();

                var data = {
                    device: device1 || '',
                    views: [],
                    scripts: []
                };
                if (view1) data.views.push(view1);
                if (view2) data.views.push(view2);
                if (script1) data.scripts.push(script1);
                if (script2) data.scripts.push(script2);
                if (script3) data.scripts.push(script3);
                if (script4) data.scripts.push(script4);

                localStorage.setItem("LAST", JSON.stringify(data));
            }

            function loadSelection() {
                var lData = localStorage.getItem("LAST");
                if (lData) {
                    var j = JSON.parse(lData);
                    applySelection(j);
                }

                var configData = localStorage.getItem("CONFIGS");
                if (configData) {
                    configData = JSON.parse(configData);
                    configs = [];
                    var i;
                    for (i = 0; i < configData.length; i++) {
                        configs.push(configData[i]);
                    }
                    buildConfigs();
                }
            }

            function applySelection(j) {
                var device1 = $('#device1').val('');
                var view1 = $('#view1').val('');
                var view2 = $('#view2').val('').prop('disabled', true);
                var script1 = $('#script1').val('');
                var script2 = $('#script2').val('').prop('disabled', true);
                var script3 = $('#script3').val('').prop('disabled', true);
                var script4 = $('#script4').val('').prop('disabled', true);

                if (j.device) device1.val(j.device);
                if (j.views && j.views.length > 0) {
                    view1.val(j.views[0]);
                    view2.prop('disabled', false);
                }
                if (j.views && j.views.length > 1)
                    view2.val(j.views[1]);
                if (j.scripts && j.scripts.length > 0) {
                    script1.val(j.scripts[0]);
                    script2.prop('disabled', false);
                }
                if (j.scripts && j.scripts.length > 1) {
                    script2.val(j.scripts[1]);
                    script3.prop('disabled', false);
                }
                if (j.scripts && j.scripts.length > 2) {
                    script3.val(j.scripts[2]);
                    script4.prop('disabled', false);
                }
                if (j.scripts && j.scripts.length > 3)
                    script4.val(j.scripts[3]);
            }

            function buildConfigs() {
                var i;
                $('.customConfig',configList).remove();
                for (i = 0; i < configs.length; i++) {
                    createConfigItem(i, configs[i].title)
                }
            }

            function createConfigItem(index, title) {
                var wrap, card, body, bntGroup;
                wrap = $('<div class="col-sm-12 col-md-6 col-lg-4 col-xl-3 customConfig"></div>');
                card = $('<div class="card shadow-sm"></div>');
                $('<div class="card-header"></div>').append($('<h4 class="my-0 font-weight-normal"></h4>').text(title || 'Untitled')).appendTo(card);
                body = $('<div class="card-body"></div>').appendTo(card);
                bntGroup = $('<div class="btn-group" role="group" aria-label="Controls"></div>').appendTo(body);
                bntGroup.append($('<button type="button" class="btn run-config btn-primary">Run</button>').attr('index', index));
                //bntGroup.append($('<button type="button" class="btn btn-outline-dark">Modify</button>').attr('index', index));
                bntGroup.append($('<button type="button" class="btn delete-config btn-outline-danger">Delete</button>').attr('index', index));
                wrap.append(card);
                configList.append(wrap);
            }

            setTimeout(firstTimeLoad, 100);
        });



    </script>
</head>
<body>

<div class="container-fluid">

    <!-- !!!!!!!! -->

    <nav class="navbar navbar-expand-md navbar-dark bg-dark" style="margin-bottom: 1em;">
        <a class="navbar-brand" href="#">Phone Piper</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample01" aria-controls="navbarsExample01" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarsExample01">
            <ul class="nav navbar-nav mr-auto" id="myTab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="config-tab" data-toggle="tab" href="#config" role="tab" aria-controls="config" aria-selected="true">Config</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="run-tab" data-toggle="tab" href="#run" role="tab" aria-controls="run" aria-selected="false">Run</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="vars-tab" data-toggle="tab" href="#vars" role="tab" aria-controls="vars" aria-selected="false">Variables</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="device-tab" data-toggle="tab" href="#device" role="tab" aria-controls="device" aria-selected="false">Device</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="edit-tab" data-toggle="tab" href="#edit" role="tab" aria-controls="edit" aria-selected="false">Edit</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="console-tab" data-toggle="tab" href="#console" role="tab" aria-controls="console" aria-selected="false">Console</a>
                </li>
            </ul>

        </div>
    </nav>

    <!-- !!!!!!!! -->

    <div class="tab-content" id="myTabContent">

        <div class="tab-pane fade show active text-center" id="home" role="tabpanel" aria-labelledby="home-tab">

            <div class="col-sm-12">
                <img src="/piper/resource/PhonePiper-Large.png" class="img-fluid" alt="Responsive image"/>
            </div>

            <div class="col-sm-12">
                <h3>Available Configs</h3>
            </div>

            <div class="row text-center" id="config-list">

                <div class="col-sm-12 col-md-6 col-lg-4 col-xl-3">
                    <div class="card shadow-sm">
                        <div class="card-header">
                            <h4 class="my-0 font-weight-normal">New Configuration</h4>
                        </div>
                        <div class="card-body">
                            <button type="button" id="new-config" class="btn btn-lg btn-block btn-outline-primary">Create</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="tab-pane fade show" id="config" role="tabpanel" aria-labelledby="config-tab">

            <form id="setting-form" class="col-sm-12" style="display:none;">
                <h3>Loader</h3>

                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Device</span>
                    </div>
                    <select class="form-control" id="device1"></select>
                </div>
                <br/>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Primary View</span>
                    </div>
                    <select class="form-control" id="view1"></select>
                </div>
                <br/>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Extra View</span>
                    </div>
                    <select class="form-control" id="view2" disabled></select>
                </div>
                <br/>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Primary Script</span>
                    </div>
                    <select class="form-control" id="script1"></select>
                </div>
                <br/>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Extra Script</span>
                    </div>
                    <select class="form-control" id="script2" disabled></select>
                </div>
                <br/>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Extra Script</span>
                    </div>
                    <select class="form-control" id="script3" disabled></select>
                </div><br/>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Extra Script</span>
                    </div>
                    <select class="form-control" id="script4" disabled></select>
                </div>
                <br/>
                <div class="form-group">
                    <button type="button" id="controlLoad" class="btn btn-primary">Run Script</button>
                    <button type="button" id="controlEditView" class="btn btn-secondary">Edit View</button>
                    <button type="button" id="controlSave" class="btn btn-dark">Save</button>
                </div>
            </form>

        </div>
        <div class="tab-pane fade" id="run" role="tabpanel" aria-labelledby="run-tab">

            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <a class="navbar-brand" href="#" id="statusName">CHECKING</a>
            </nav>

            <form id="loaded-form" class="col-sm-12" style="display:none;">
                <h3>Run</h3>
                <div class="form-group">
                    <label for="states">State</label>
                    <select id="states" class="form-control"></select>
                </div>
                <div class="form-group">
                    <button type="button" id="controlPlayPause" class="btn btn-primary">Play/Pause</button>
                    <button type="button" id="controlUnload" class="btn btn-danger notWhileRunning">Unload</button>
                    <button type="button" id="controlKill" class="btn btn-danger">Kill</button>
                </div>
                <div class="form-group">
                    <label for="webLogging">Web Logging</label>
                    <select id="webLogging" class="form-control logging" mode="web">
                        <option value="SEVERE">Severe</option>
                        <option value="INFO" selected>Info</option>
                        <option value="FINER">Finer</option>
                        <option value="FINEST">Finest</option>
                        <option value="OFF">Off</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="fileLogging">File Logging</label>
                    <select id="fileLogging" class="form-control logging" mode="file">
                        <option value="SEVERE">Severe</option>
                        <option value="INFO" selected>Info</option>
                        <option value="FINER">Finer</option>
                        <option value="FINEST">Finest</option>
                        <option value="OFF">Off</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="components">Components</label>
                    <select id="components" class="form-control notWhileRunning"></select>
                </div>
                <div class="form-group">
                    <button type="button" id="controlTap" controlButton="TAP"
                            class="btn btn-info notWhileRunning controlButton">Tap
                    </button>
                    <button type="button" id="controlSwipeUp" controlButton="SWIPE_UP"
                            class="btn btn-info notWhileRunning controlButton">Up
                    </button>
                    <button type="button" id="controlSwipeRight" controlButton="SWIPE_RIGHT"
                            class="btn btn-info notWhileRunning controlButton">Right
                    </button>
                    <button type="button" id="controlSwipeDown" controlButton="SWIPE_DOWN"
                            class="btn btn-info notWhileRunning controlButton">Down
                    </button>
                    <button type="button" id="controlSwipeLeft" controlButton="SWIPE_LEFT"
                            class="btn btn-info notWhileRunning controlButton">Left
                    </button>

                    <button type="button" id="controlSlowUp" controlButton="SLOW_UP"
                            class="btn btn-warning notWhileRunning controlButton">Up
                    </button>
                    <button type="button" id="controlSlowRight" controlButton="SLOW_RIGHT"
                            class="btn btn-warning notWhileRunning controlButton">Right
                    </button>
                    <button type="button" id="controlSlowDown" controlButton="SLOW_DOWN"
                            class="btn btn-warning notWhileRunning controlButton">Down
                    </button>
                    <button type="button" id="controlSlowLeft" controlButton="SLOW_LEFT"
                            class="btn btn-warning notWhileRunning controlButton">Left
                    </button>
                </div>
            </form>

        </div>

        <div class="tab-pane fade" id="device" role="tabpanel" aria-labelledby="device-tab">

            <form id="player-form" class="col-sm-12" style="display:none;">

                <h3>Settings</h3>

                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Player Level</span>
                    </div>
                    <input type="number" class="form-control" id="player-level"/>
                    <div class="input-group-append">
                        <button type="button" id="controlPlayerSave" class="btn btn-primary">Update</button>
                    </div>
                </div>
                <br/>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Device I.P.</span>
                    </div>
                    <input class="form-control" id="device-ip"/>
                    <div class="input-group-append">
                        <button type="button" id="controlDeviceSave" class="btn btn-primary">Update</button>
                    </div>
                </div>
                <br/>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Direct Identity</span>
                    </div>
                    <input class="form-control" id="device-direct"/>
                    <div class="input-group-append">
                        <button type="button" id="controlDeviceDirectSave" class="btn btn-primary">Update</button>
                    </div>
                </div>
                <br/>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">ADB Path</span>
                    </div>
                    <input class="form-control" id="device-adb"/>
                    <div class="input-group-append">
                        <button type="button" id="controlDeviceAdbSave" class="btn btn-primary">Update</button>
                    </div>
                </div>

                <div class="alert alert-light" role="alert">
                    The path to your ADB instance you wish to run against.
                </div>

                <br/>
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Wifi?</span>
                    </div>
                    <select class="form-control" id="device-wifi">
                        <option value="true">True</option>
                        <option value="false">False</option>
                    </select>
                    <div class="input-group-append">
                        <button type="button" id="controlDeviceWifiSave" class="btn btn-primary">Update</button>
                    </div>
                </div>

                <br/>

                <div class="form-group">
                    <label for="adb-info">ADB</label>
                    <textarea class="form-control" id="adb-info" rows="3"></textarea>
                </div>

                <div class="input-group">
                    <button type="button" class="btn controlAdb btn-info notWhileRunning" adb="restart">Restart</button>
                    <button type="button" class="btn controlAdb btn-info notWhileRunning" adb="usb">USB</button>
                    <button type="button" class="btn controlAdb btn-info notWhileRunning" adb="remote">Remote</button>
                    <button type="button" class="btn controlAdb btn-info notWhileRunning" adb="kill">Kill</button>
                    <button type="button" class="btn controlAdb btn-info notWhileRunning" adb="connect">Connect</button>
                    <button type="button" class="btn controlAdb btn-info notWhileRunning" adb="devices">Devices</button>
                </div>
                <br/>

                <div class="form-group">
                    <label for="adb-info">Preview</label>
                    <br/>
                    <img id="previewImage" src="" class="img-fluid" alt="Responsive image">
                </div>
                <div class="input-group">
                    <button type="button" id="controlUpdatePreview" class="btn btn-info notWhileRunning">Update Preview</button>
                </div>

            </form>


        </div>
        <div class="tab-pane fade" id="edit" role="tabpanel" aria-labelledby="edit-tab">

            <form id="edit-form" class="col-sm-4" style="display:none;">
                <div class="form-group">
                    <button type="button" id="unloadEdit" class="btn  btn-danger notWhileRunning">Unload</button>
                </div>

                <div class="form-group">
                    <label for="edit-screens">Screens</label>
                    <select id="edit-screens" class="form-control notWhileRunning"></select>
                </div>

                <div class="form-group">
                    <button type="button" id="newScreen" class="btn btn-info">New</button>
                    <button type="button" id="stubScreen" class="btn btn-info">Stub</button>
                    <button type="button" id="editScreen" class="btn btn-info">Edit</button>
                    <button type="button" id="fixScreen" class="btn btn-info">Fix</button>
                    <button type="button" id="verifyScreen" class="btn btn-info">Verify</button>
                    <button type="button" id="updateScreen" class="btn btn-info">Update</button>
                </div>

                <div class="form-group">
                    <label for="edit-components">Components</label>
                    <select id="edit-components" class="form-control notWhileRunning"></select>
                </div>

                <div class="form-group">
                    <div class="form-group">
                        <button type="button" id="newComponent" class="btn btn-info">New</button>
                        <button type="button" id="stubComponent" class="btn btn-info">Stub</button>
                        <button type="button" id="editComponent" class="btn btn-info">Edit</button>
                        <button type="button" id="updateComponent" class="btn btn-info">Update</button>
                    </div>
                </div>


            </form>

        </div>
        <div class="tab-pane fade" id="vars" role="tabpanel" aria-labelledby="vars-tab">

            <div class="row">
                <form id="variable-form" class="col-sm-12" style="display:none;">
                    <h3>Variables</h3>
                    <div id="variable-container" class="container-fluid">



                    </div>
                </form>
            </div>

        </div>
        <div class="tab-pane fade" id="console" role="tabpanel" aria-labelledby="console-tab">
            <div id="logs" class="container-fluid"></div>
        </div>
    </div>


</div>


</body>
</html>